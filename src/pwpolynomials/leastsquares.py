import numpy as np

def lstsq_1_1(
    x0, k, n, sumh_x, sumh_x2, sumt_x, sumt_x2, sumh_y, sumh_y2, sumt_y, sumt_y2, sumh_yx, sumt_yx
):
    x0 = float(x0)
    T = np.array(
        [
            [n, sumh_x + x0 * (-k + n), sumt_x - x0 * (-k + n)],
            [sumh_x + x0 * (-k + n), sumh_x2 + x0**2 * (-k + n), x0 * (sumt_x - x0 * (-k + n))],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array([sumh_y + sumt_y, sumh_yx + sumt_y * x0, -sumt_y * x0 + sumt_yx], dtype=np.float64)
    coefs = np.linalg.solve(T, R)
    a = coefs[:2]
    b = np.concatenate((np.array([-0.0]), coefs[2:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1) - (b[1] * x0**1)
    return a, b


def lstsq_1_2(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumt_yx,
    sumt_yx2,
):
    x0 = float(x0)
    T = np.array(
        [
            [n, sumh_x + x0 * (-k + n), sumt_x - x0 * (-k + n), sumt_x2 - x0**2 * (-k + n)],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:2]
    b = np.concatenate((np.array([-0.0]), coefs[2:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1) - (b[1] * x0**1 + b[2] * x0**2)
    return a, b


def lstsq_1_3(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:2]
    b = np.concatenate((np.array([-0.0]), coefs[2:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1) - (b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3)
    return a, b


def lstsq_1_4(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:2]
    b = np.concatenate((np.array([-0.0]), coefs[2:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4
    )
    return a, b


def lstsq_1_5(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:2]
    b = np.concatenate((np.array([-0.0]), coefs[2:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4 + b[5] * x0**5
    )
    return a, b


def lstsq_1_6(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:2]
    b = np.concatenate((np.array([-0.0]), coefs[2:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
    )
    return a, b


def lstsq_1_7(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumt_x13,
    sumt_x14,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
    sumt_yx7,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
                sumt_x7 - x0**7 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
            ],
            [
                sumt_x7 - x0**7 * (-k + n),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
                sumt_x14 - 2 * sumt_x7 * x0**7 + x0**14 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
            -sumt_y * x0**7 + sumt_yx7,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:2]
    b = np.concatenate((np.array([-0.0]), coefs[2:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
        + b[7] * x0**7
    )
    return a, b


def lstsq_2_1(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumt_x,
    sumt_x2,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumt_yx,
):
    x0 = float(x0)
    T = np.array(
        [
            [n, sumh_x + x0 * (-k + n), sumh_x2 + x0**2 * (-k + n), sumt_x - x0 * (-k + n)],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            -sumt_y * x0 + sumt_yx,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:3]
    b = np.concatenate((np.array([-0.0]), coefs[3:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2) - (b[1] * x0**1)
    return a, b


def lstsq_2_2(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumt_yx,
    sumt_yx2,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:3]
    b = np.concatenate((np.array([-0.0]), coefs[3:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2) - (b[1] * x0**1 + b[2] * x0**2)
    return a, b


def lstsq_2_3(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:3]
    b = np.concatenate((np.array([-0.0]), coefs[3:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3
    )
    return a, b


def lstsq_2_4(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:3]
    b = np.concatenate((np.array([-0.0]), coefs[3:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4
    )
    return a, b


def lstsq_2_5(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:3]
    b = np.concatenate((np.array([-0.0]), coefs[3:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4 + b[5] * x0**5
    )
    return a, b


def lstsq_2_6(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:3]
    b = np.concatenate((np.array([-0.0]), coefs[3:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
    )
    return a, b


def lstsq_2_7(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumt_x13,
    sumt_x14,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
    sumt_yx7,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
                sumt_x7 - x0**7 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
            ],
            [
                sumt_x7 - x0**7 * (-k + n),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
                sumt_x14 - 2 * sumt_x7 * x0**7 + x0**14 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
            -sumt_y * x0**7 + sumt_yx7,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:3]
    b = np.concatenate((np.array([-0.0]), coefs[3:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
        + b[7] * x0**7
    )
    return a, b


def lstsq_3_1(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumt_x,
    sumt_x2,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumt_yx,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumt_x - x0 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            -sumt_y * x0 + sumt_yx,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:4]
    b = np.concatenate((np.array([-0.0]), coefs[4:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3) - (b[1] * x0**1)
    return a, b


def lstsq_3_2(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumt_yx,
    sumt_yx2,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:4]
    b = np.concatenate((np.array([-0.0]), coefs[4:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3) - (
        b[1] * x0**1 + b[2] * x0**2
    )
    return a, b


def lstsq_3_3(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:4]
    b = np.concatenate((np.array([-0.0]), coefs[4:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3
    )
    return a, b


def lstsq_3_4(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:4]
    b = np.concatenate((np.array([-0.0]), coefs[4:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4
    )
    return a, b


def lstsq_3_5(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:4]
    b = np.concatenate((np.array([-0.0]), coefs[4:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4 + b[5] * x0**5
    )
    return a, b


def lstsq_3_6(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:4]
    b = np.concatenate((np.array([-0.0]), coefs[4:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
    )
    return a, b


def lstsq_3_7(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumt_x13,
    sumt_x14,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
    sumt_yx7,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
                sumt_x7 - x0**7 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
            ],
            [
                sumt_x7 - x0**7 * (-k + n),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
                x0**3 * (sumt_x7 - x0**7 * (-k + n)),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
                sumt_x14 - 2 * sumt_x7 * x0**7 + x0**14 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
            -sumt_y * x0**7 + sumt_yx7,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:4]
    b = np.concatenate((np.array([-0.0]), coefs[4:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
        + b[7] * x0**7
    )
    return a, b


def lstsq_4_1(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumt_x,
    sumt_x2,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumt_yx,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumt_x - x0 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            -sumt_y * x0 + sumt_yx,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:5]
    b = np.concatenate((np.array([-0.0]), coefs[5:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3 + a[4] * x0**4) - (
        b[1] * x0**1
    )
    return a, b


def lstsq_4_2(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumt_yx,
    sumt_yx2,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:5]
    b = np.concatenate((np.array([-0.0]), coefs[5:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3 + a[4] * x0**4) - (
        b[1] * x0**1 + b[2] * x0**2
    )
    return a, b


def lstsq_4_3(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:5]
    b = np.concatenate((np.array([-0.0]), coefs[5:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3 + a[4] * x0**4) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3
    )
    return a, b


def lstsq_4_4(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:5]
    b = np.concatenate((np.array([-0.0]), coefs[5:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3 + a[4] * x0**4) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4
    )
    return a, b


def lstsq_4_5(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:5]
    b = np.concatenate((np.array([-0.0]), coefs[5:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3 + a[4] * x0**4) - (
        b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4 + b[5] * x0**5
    )
    return a, b


def lstsq_4_6(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:5]
    b = np.concatenate((np.array([-0.0]), coefs[5:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3 + a[4] * x0**4) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
    )
    return a, b


def lstsq_4_7(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumt_x13,
    sumt_x14,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
    sumt_yx7,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
                sumt_x7 - x0**7 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
            ],
            [
                sumt_x7 - x0**7 * (-k + n),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
                x0**3 * (sumt_x7 - x0**7 * (-k + n)),
                x0**4 * (sumt_x7 - x0**7 * (-k + n)),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
                sumt_x14 - 2 * sumt_x7 * x0**7 + x0**14 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
            -sumt_y * x0**7 + sumt_yx7,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:5]
    b = np.concatenate((np.array([-0.0]), coefs[5:]))
    b[0] = (a[0] * x0**0 + a[1] * x0**1 + a[2] * x0**2 + a[3] * x0**3 + a[4] * x0**4) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
        + b[7] * x0**7
    )
    return a, b


def lstsq_5_1(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumt_x,
    sumt_x2,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumt_yx,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumt_x - x0 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            -sumt_y * x0 + sumt_yx,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:6]
    b = np.concatenate((np.array([-0.0]), coefs[6:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
    ) - (b[1] * x0**1)
    return a, b


def lstsq_5_2(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumt_yx,
    sumt_yx2,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:6]
    b = np.concatenate((np.array([-0.0]), coefs[6:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
    ) - (b[1] * x0**1 + b[2] * x0**2)
    return a, b


def lstsq_5_3(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:6]
    b = np.concatenate((np.array([-0.0]), coefs[6:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
    ) - (b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3)
    return a, b


def lstsq_5_4(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:6]
    b = np.concatenate((np.array([-0.0]), coefs[6:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
    ) - (b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4)
    return a, b


def lstsq_5_5(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:6]
    b = np.concatenate((np.array([-0.0]), coefs[6:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
    ) - (b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4 + b[5] * x0**5)
    return a, b


def lstsq_5_6(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:6]
    b = np.concatenate((np.array([-0.0]), coefs[6:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
    ) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
    )
    return a, b


def lstsq_5_7(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumt_x13,
    sumt_x14,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
    sumt_yx7,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
                sumt_x7 - x0**7 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
                x0**5 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
            ],
            [
                sumt_x7 - x0**7 * (-k + n),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
                x0**3 * (sumt_x7 - x0**7 * (-k + n)),
                x0**4 * (sumt_x7 - x0**7 * (-k + n)),
                x0**5 * (sumt_x7 - x0**7 * (-k + n)),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
                sumt_x14 - 2 * sumt_x7 * x0**7 + x0**14 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
            -sumt_y * x0**7 + sumt_yx7,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:6]
    b = np.concatenate((np.array([-0.0]), coefs[6:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
    ) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
        + b[7] * x0**7
    )
    return a, b


def lstsq_6_1(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumt_x,
    sumt_x2,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumt_yx,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumt_x - x0 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            -sumt_y * x0 + sumt_yx,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:7]
    b = np.concatenate((np.array([-0.0]), coefs[7:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
    ) - (b[1] * x0**1)
    return a, b


def lstsq_6_2(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumt_yx,
    sumt_yx2,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:7]
    b = np.concatenate((np.array([-0.0]), coefs[7:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
    ) - (b[1] * x0**1 + b[2] * x0**2)
    return a, b


def lstsq_6_3(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:7]
    b = np.concatenate((np.array([-0.0]), coefs[7:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
    ) - (b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3)
    return a, b


def lstsq_6_4(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:7]
    b = np.concatenate((np.array([-0.0]), coefs[7:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
    ) - (b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4)
    return a, b


def lstsq_6_5(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:7]
    b = np.concatenate((np.array([-0.0]), coefs[7:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
    ) - (b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4 + b[5] * x0**5)
    return a, b


def lstsq_6_6(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
                x0**6 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
                x0**6 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:7]
    b = np.concatenate((np.array([-0.0]), coefs[7:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
    ) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
    )
    return a, b


def lstsq_6_7(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumt_x13,
    sumt_x14,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
    sumt_yx7,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
                sumt_x7 - x0**7 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
                x0**5 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
                x0**6 * (sumt_x6 - x0**6 * (-k + n)),
                x0**6 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
                x0**6 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
            ],
            [
                sumt_x7 - x0**7 * (-k + n),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
                x0**3 * (sumt_x7 - x0**7 * (-k + n)),
                x0**4 * (sumt_x7 - x0**7 * (-k + n)),
                x0**5 * (sumt_x7 - x0**7 * (-k + n)),
                x0**6 * (sumt_x7 - x0**7 * (-k + n)),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
                sumt_x14 - 2 * sumt_x7 * x0**7 + x0**14 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
            -sumt_y * x0**7 + sumt_yx7,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:7]
    b = np.concatenate((np.array([-0.0]), coefs[7:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
    ) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
        + b[7] * x0**7
    )
    return a, b


def lstsq_7_1(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumh_x13,
    sumh_x14,
    sumt_x,
    sumt_x2,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumh_yx7,
    sumt_yx,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumt_x - x0 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                sumh_x14 + x0**14 * (-k + n),
                x0**7 * (sumt_x - x0 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            sumh_yx7 + sumt_y * x0**7,
            -sumt_y * x0 + sumt_yx,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:8]
    b = np.concatenate((np.array([-0.0]), coefs[8:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
        + a[7] * x0**7
    ) - (b[1] * x0**1)
    return a, b


def lstsq_7_2(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumh_x13,
    sumh_x14,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumh_yx7,
    sumt_yx,
    sumt_yx2,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                sumh_x14 + x0**14 * (-k + n),
                x0**7 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            sumh_yx7 + sumt_y * x0**7,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:8]
    b = np.concatenate((np.array([-0.0]), coefs[8:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
        + a[7] * x0**7
    ) - (b[1] * x0**1 + b[2] * x0**2)
    return a, b


def lstsq_7_3(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumh_x13,
    sumh_x14,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumh_yx7,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                sumh_x14 + x0**14 * (-k + n),
                x0**7 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x3 - x0**3 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**7 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            sumh_yx7 + sumt_y * x0**7,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:8]
    b = np.concatenate((np.array([-0.0]), coefs[8:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
        + a[7] * x0**7
    ) - (b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3)
    return a, b


def lstsq_7_4(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumh_x13,
    sumh_x14,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumh_yx7,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                sumh_x14 + x0**14 * (-k + n),
                x0**7 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x3 - x0**3 * (-k + n)),
                x0**7 * (sumt_x4 - x0**4 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**7 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                x0**7 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            sumh_yx7 + sumt_y * x0**7,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:8]
    b = np.concatenate((np.array([-0.0]), coefs[8:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
        + a[7] * x0**7
    ) - (b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4)
    return a, b


def lstsq_7_5(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumh_x13,
    sumh_x14,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumh_yx7,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                sumh_x14 + x0**14 * (-k + n),
                x0**7 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x3 - x0**3 * (-k + n)),
                x0**7 * (sumt_x4 - x0**4 * (-k + n)),
                x0**7 * (sumt_x5 - x0**5 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**7 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                x0**7 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
                x0**7 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            sumh_yx7 + sumt_y * x0**7,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:8]
    b = np.concatenate((np.array([-0.0]), coefs[8:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
        + a[7] * x0**7
    ) - (b[1] * x0**1 + b[2] * x0**2 + b[3] * x0**3 + b[4] * x0**4 + b[5] * x0**5)
    return a, b


def lstsq_7_6(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumh_x13,
    sumh_x14,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumh_yx7,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
                x0**6 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                sumh_x14 + x0**14 * (-k + n),
                x0**7 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x3 - x0**3 * (-k + n)),
                x0**7 * (sumt_x4 - x0**4 * (-k + n)),
                x0**7 * (sumt_x5 - x0**5 * (-k + n)),
                x0**7 * (sumt_x6 - x0**6 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**7 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                x0**7 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
                x0**7 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
                x0**6 * (sumt_x6 - x0**6 * (-k + n)),
                x0**7 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            sumh_yx7 + sumt_y * x0**7,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:8]
    b = np.concatenate((np.array([-0.0]), coefs[8:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
        + a[7] * x0**7
    ) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
    )
    return a, b


def lstsq_7_7(
    x0,
    k,
    n,
    sumh_x,
    sumh_x2,
    sumh_x3,
    sumh_x4,
    sumh_x5,
    sumh_x6,
    sumh_x7,
    sumh_x8,
    sumh_x9,
    sumh_x10,
    sumh_x11,
    sumh_x12,
    sumh_x13,
    sumh_x14,
    sumt_x,
    sumt_x2,
    sumt_x3,
    sumt_x4,
    sumt_x5,
    sumt_x6,
    sumt_x7,
    sumt_x8,
    sumt_x9,
    sumt_x10,
    sumt_x11,
    sumt_x12,
    sumt_x13,
    sumt_x14,
    sumh_y,
    sumh_y2,
    sumt_y,
    sumt_y2,
    sumh_yx,
    sumh_yx2,
    sumh_yx3,
    sumh_yx4,
    sumh_yx5,
    sumh_yx6,
    sumh_yx7,
    sumt_yx,
    sumt_yx2,
    sumt_yx3,
    sumt_yx4,
    sumt_yx5,
    sumt_yx6,
    sumt_yx7,
):
    x0 = float(x0)
    T = np.array(
        [
            [
                n,
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumt_x - x0 * (-k + n),
                sumt_x2 - x0**2 * (-k + n),
                sumt_x3 - x0**3 * (-k + n),
                sumt_x4 - x0**4 * (-k + n),
                sumt_x5 - x0**5 * (-k + n),
                sumt_x6 - x0**6 * (-k + n),
                sumt_x7 - x0**7 * (-k + n),
            ],
            [
                sumh_x + x0 * (-k + n),
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x2 + x0**2 * (-k + n),
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x3 + x0**3 * (-k + n),
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x4 + x0**4 * (-k + n),
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x5 + x0**5 * (-k + n),
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
                x0**5 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x6 + x0**6 * (-k + n),
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
                x0**6 * (sumt_x6 - x0**6 * (-k + n)),
                x0**6 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumh_x7 + x0**7 * (-k + n),
                sumh_x8 + x0**8 * (-k + n),
                sumh_x9 + x0**9 * (-k + n),
                sumh_x10 + x0**10 * (-k + n),
                sumh_x11 + x0**11 * (-k + n),
                sumh_x12 + x0**12 * (-k + n),
                sumh_x13 + x0**13 * (-k + n),
                sumh_x14 + x0**14 * (-k + n),
                x0**7 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x3 - x0**3 * (-k + n)),
                x0**7 * (sumt_x4 - x0**4 * (-k + n)),
                x0**7 * (sumt_x5 - x0**5 * (-k + n)),
                x0**7 * (sumt_x6 - x0**6 * (-k + n)),
                x0**7 * (sumt_x7 - x0**7 * (-k + n)),
            ],
            [
                sumt_x - x0 * (-k + n),
                x0 * (sumt_x - x0 * (-k + n)),
                x0**2 * (sumt_x - x0 * (-k + n)),
                x0**3 * (sumt_x - x0 * (-k + n)),
                x0**4 * (sumt_x - x0 * (-k + n)),
                x0**5 * (sumt_x - x0 * (-k + n)),
                x0**6 * (sumt_x - x0 * (-k + n)),
                x0**7 * (sumt_x - x0 * (-k + n)),
                -2 * sumt_x * x0 + sumt_x2 + x0**2 * (-k + n),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
            ],
            [
                sumt_x2 - x0**2 * (-k + n),
                x0 * (sumt_x2 - x0**2 * (-k + n)),
                x0**2 * (sumt_x2 - x0**2 * (-k + n)),
                x0**3 * (sumt_x2 - x0**2 * (-k + n)),
                x0**4 * (sumt_x2 - x0**2 * (-k + n)),
                x0**5 * (sumt_x2 - x0**2 * (-k + n)),
                x0**6 * (sumt_x2 - x0**2 * (-k + n)),
                x0**7 * (sumt_x2 - x0**2 * (-k + n)),
                -sumt_x * x0**2 - sumt_x2 * x0 + sumt_x3 + x0**3 * (-k + n),
                -2 * sumt_x2 * x0**2 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
            ],
            [
                sumt_x3 - x0**3 * (-k + n),
                x0 * (sumt_x3 - x0**3 * (-k + n)),
                x0**2 * (sumt_x3 - x0**3 * (-k + n)),
                x0**3 * (sumt_x3 - x0**3 * (-k + n)),
                x0**4 * (sumt_x3 - x0**3 * (-k + n)),
                x0**5 * (sumt_x3 - x0**3 * (-k + n)),
                x0**6 * (sumt_x3 - x0**3 * (-k + n)),
                x0**7 * (sumt_x3 - x0**3 * (-k + n)),
                -sumt_x * x0**3 - sumt_x3 * x0 + sumt_x4 + x0**4 * (-k + n),
                -sumt_x2 * x0**3 - sumt_x3 * x0**2 + sumt_x5 + x0**5 * (-k + n),
                -2 * sumt_x3 * x0**3 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
            ],
            [
                sumt_x4 - x0**4 * (-k + n),
                x0 * (sumt_x4 - x0**4 * (-k + n)),
                x0**2 * (sumt_x4 - x0**4 * (-k + n)),
                x0**3 * (sumt_x4 - x0**4 * (-k + n)),
                x0**4 * (sumt_x4 - x0**4 * (-k + n)),
                x0**5 * (sumt_x4 - x0**4 * (-k + n)),
                x0**6 * (sumt_x4 - x0**4 * (-k + n)),
                x0**7 * (sumt_x4 - x0**4 * (-k + n)),
                -sumt_x * x0**4 - sumt_x4 * x0 + sumt_x5 + x0**5 * (-k + n),
                -sumt_x2 * x0**4 - sumt_x4 * x0**2 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x3 * x0**4 - sumt_x4 * x0**3 + sumt_x7 + x0**7 * (-k + n),
                -2 * sumt_x4 * x0**4 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
            ],
            [
                sumt_x5 - x0**5 * (-k + n),
                x0 * (sumt_x5 - x0**5 * (-k + n)),
                x0**2 * (sumt_x5 - x0**5 * (-k + n)),
                x0**3 * (sumt_x5 - x0**5 * (-k + n)),
                x0**4 * (sumt_x5 - x0**5 * (-k + n)),
                x0**5 * (sumt_x5 - x0**5 * (-k + n)),
                x0**6 * (sumt_x5 - x0**5 * (-k + n)),
                x0**7 * (sumt_x5 - x0**5 * (-k + n)),
                -sumt_x * x0**5 - sumt_x5 * x0 + sumt_x6 + x0**6 * (-k + n),
                -sumt_x2 * x0**5 - sumt_x5 * x0**2 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x3 * x0**5 - sumt_x5 * x0**3 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x4 * x0**5 - sumt_x5 * x0**4 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - 2 * sumt_x5 * x0**5 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
            ],
            [
                sumt_x6 - x0**6 * (-k + n),
                x0 * (sumt_x6 - x0**6 * (-k + n)),
                x0**2 * (sumt_x6 - x0**6 * (-k + n)),
                x0**3 * (sumt_x6 - x0**6 * (-k + n)),
                x0**4 * (sumt_x6 - x0**6 * (-k + n)),
                x0**5 * (sumt_x6 - x0**6 * (-k + n)),
                x0**6 * (sumt_x6 - x0**6 * (-k + n)),
                x0**7 * (sumt_x6 - x0**6 * (-k + n)),
                -sumt_x * x0**6 - sumt_x6 * x0 + sumt_x7 + x0**7 * (-k + n),
                -sumt_x2 * x0**6 - sumt_x6 * x0**2 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x3 * x0**6 - sumt_x6 * x0**3 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x4 * x0**6 - sumt_x6 * x0**4 + x0**10 * (-k + n),
                sumt_x11 - sumt_x5 * x0**6 - sumt_x6 * x0**5 + x0**11 * (-k + n),
                sumt_x12 - 2 * sumt_x6 * x0**6 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
            ],
            [
                sumt_x7 - x0**7 * (-k + n),
                x0 * (sumt_x7 - x0**7 * (-k + n)),
                x0**2 * (sumt_x7 - x0**7 * (-k + n)),
                x0**3 * (sumt_x7 - x0**7 * (-k + n)),
                x0**4 * (sumt_x7 - x0**7 * (-k + n)),
                x0**5 * (sumt_x7 - x0**7 * (-k + n)),
                x0**6 * (sumt_x7 - x0**7 * (-k + n)),
                x0**7 * (sumt_x7 - x0**7 * (-k + n)),
                -sumt_x * x0**7 - sumt_x7 * x0 + sumt_x8 + x0**8 * (-k + n),
                -sumt_x2 * x0**7 - sumt_x7 * x0**2 + sumt_x9 + x0**9 * (-k + n),
                sumt_x10 - sumt_x3 * x0**7 - sumt_x7 * x0**3 + x0**10 * (-k + n),
                sumt_x11 - sumt_x4 * x0**7 - sumt_x7 * x0**4 + x0**11 * (-k + n),
                sumt_x12 - sumt_x5 * x0**7 - sumt_x7 * x0**5 + x0**12 * (-k + n),
                sumt_x13 - sumt_x6 * x0**7 - sumt_x7 * x0**6 + x0**13 * (-k + n),
                sumt_x14 - 2 * sumt_x7 * x0**7 + x0**14 * (-k + n),
            ],
        ],
        dtype=np.float64,
    )
    R = np.array(
        [
            sumh_y + sumt_y,
            sumh_yx + sumt_y * x0,
            sumh_yx2 + sumt_y * x0**2,
            sumh_yx3 + sumt_y * x0**3,
            sumh_yx4 + sumt_y * x0**4,
            sumh_yx5 + sumt_y * x0**5,
            sumh_yx6 + sumt_y * x0**6,
            sumh_yx7 + sumt_y * x0**7,
            -sumt_y * x0 + sumt_yx,
            -sumt_y * x0**2 + sumt_yx2,
            -sumt_y * x0**3 + sumt_yx3,
            -sumt_y * x0**4 + sumt_yx4,
            -sumt_y * x0**5 + sumt_yx5,
            -sumt_y * x0**6 + sumt_yx6,
            -sumt_y * x0**7 + sumt_yx7,
        ],
        dtype=np.float64,
    )
    coefs = np.linalg.solve(T, R)
    a = coefs[:8]
    b = np.concatenate((np.array([-0.0]), coefs[8:]))
    b[0] = (
        a[0] * x0**0
        + a[1] * x0**1
        + a[2] * x0**2
        + a[3] * x0**3
        + a[4] * x0**4
        + a[5] * x0**5
        + a[6] * x0**6
        + a[7] * x0**7
    ) - (
        b[1] * x0**1
        + b[2] * x0**2
        + b[3] * x0**3
        + b[4] * x0**4
        + b[5] * x0**5
        + b[6] * x0**6
        + b[7] * x0**7
    )
    return a, b


dispatcher = {
    (1, 1): lstsq_1_1,
    (1, 2): lstsq_1_2,
    (1, 3): lstsq_1_3,
    (1, 4): lstsq_1_4,
    (1, 5): lstsq_1_5,
    (1, 6): lstsq_1_6,
    (1, 7): lstsq_1_7,
    (2, 1): lstsq_2_1,
    (2, 2): lstsq_2_2,
    (2, 3): lstsq_2_3,
    (2, 4): lstsq_2_4,
    (2, 5): lstsq_2_5,
    (2, 6): lstsq_2_6,
    (2, 7): lstsq_2_7,
    (3, 1): lstsq_3_1,
    (3, 2): lstsq_3_2,
    (3, 3): lstsq_3_3,
    (3, 4): lstsq_3_4,
    (3, 5): lstsq_3_5,
    (3, 6): lstsq_3_6,
    (3, 7): lstsq_3_7,
    (4, 1): lstsq_4_1,
    (4, 2): lstsq_4_2,
    (4, 3): lstsq_4_3,
    (4, 4): lstsq_4_4,
    (4, 5): lstsq_4_5,
    (4, 6): lstsq_4_6,
    (4, 7): lstsq_4_7,
    (5, 1): lstsq_5_1,
    (5, 2): lstsq_5_2,
    (5, 3): lstsq_5_3,
    (5, 4): lstsq_5_4,
    (5, 5): lstsq_5_5,
    (5, 6): lstsq_5_6,
    (5, 7): lstsq_5_7,
    (6, 1): lstsq_6_1,
    (6, 2): lstsq_6_2,
    (6, 3): lstsq_6_3,
    (6, 4): lstsq_6_4,
    (6, 5): lstsq_6_5,
    (6, 6): lstsq_6_6,
    (6, 7): lstsq_6_7,
    (7, 1): lstsq_7_1,
    (7, 2): lstsq_7_2,
    (7, 3): lstsq_7_3,
    (7, 4): lstsq_7_4,
    (7, 5): lstsq_7_5,
    (7, 6): lstsq_7_6,
    (7, 7): lstsq_7_7
}